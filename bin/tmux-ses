#!/usr/bin/env sh

directory="~"
if [ $# -eq 1 ]; then
  ses_name=$1
else 
  directory=$({ \
    printf "notes\nnvim\n"; \
    find \
    ~/Projects \
    ~/.local/src \
    ~/.local/src/nvim-plugins \
    ~/.local/share/nvim/lazy \
    -maxdepth 1 -type d; } | fzf)
  ses_name=$(basename "$directory" | tr "." "_")
fi

[ -z "$ses_name" ] && exit 1

if ! tmux has-session -t "$ses_name"; then
  case "$ses_name" in
    notes) 
      tmux new-session -ds "$ses_name" -c "$MY_NOTES_DIR"
    ;;
    nvim)
      tmux new-session -ds "$ses_name" -c "$XDG_CONFIG_HOME/nvim"
    ;;
    emacs)
      tmux new-session -ds "$ses_name" -c "$XDG_CONFIG_HOME/emacs"
    ;;
    *) tmux new-session -ds "$ses_name" -c "$directory"
    ;;
  esac
  
fi

if [ "$TMUX" ]; then
  tmux switch-client -t "$ses_name"
else
  tmux attach -t "$ses_name"
fi
